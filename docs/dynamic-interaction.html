<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Dynamic interaction | Interactive data with Shiny flexdashboard</title>
  <meta name="description" content="4 Dynamic interaction | Interactive data with Shiny flexdashboard" />
  <meta name="generator" content="bookdown 0.35.1 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Dynamic interaction | Interactive data with Shiny flexdashboard" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="liza-wood/intro-shiny" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Dynamic interaction | Interactive data with Shiny flexdashboard" />
  
  
  

<meta name="author" content="Liza Wood" />


<meta name="date" content="2023-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="static-interaction.html"/>
<link rel="next" href="themes-and-styling.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="styling.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./" style="font-size: 16px">Interactive data with Shiny flexdashboard</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Overview</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#set-up"><i class="fa fa-check"></i><b>0.1</b> Set up</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#package-installation"><i class="fa fa-check"></i><b>0.1.1</b> Package installation</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#shinyapps.io-account"><i class="fa fa-check"></i><b>0.1.2</b> shinyapps.io account</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="why-interactive-sites.html"><a href="why-interactive-sites.html"><i class="fa fa-check"></i><b>1</b> Why interactive sites?</a>
<ul>
<li class="chapter" data-level="1.1" data-path="why-interactive-sites.html"><a href="why-interactive-sites.html#communication-and-personalization"><i class="fa fa-check"></i><b>1.1</b> Communication and personalization</a></li>
<li class="chapter" data-level="1.2" data-path="why-interactive-sites.html"><a href="why-interactive-sites.html#teaching"><i class="fa fa-check"></i><b>1.2</b> Teaching</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="flexdashboard.html"><a href="flexdashboard.html"><i class="fa fa-check"></i><b>2</b> Flexdashboard</a>
<ul>
<li class="chapter" data-level="2.1" data-path="flexdashboard.html"><a href="flexdashboard.html#layout"><i class="fa fa-check"></i><b>2.1</b> Layout</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="static-interaction.html"><a href="static-interaction.html"><i class="fa fa-check"></i><b>3</b> Static interaction</a></li>
<li class="chapter" data-level="4" data-path="dynamic-interaction.html"><a href="dynamic-interaction.html"><i class="fa fa-check"></i><b>4</b> Dynamic interaction</a>
<ul>
<li class="chapter" data-level="4.1" data-path="dynamic-interaction.html"><a href="dynamic-interaction.html#user-interface"><i class="fa fa-check"></i><b>4.1</b> User interface</a></li>
<li class="chapter" data-level="4.2" data-path="dynamic-interaction.html"><a href="dynamic-interaction.html#server-output"><i class="fa fa-check"></i><b>4.2</b> Server output</a></li>
<li class="chapter" data-level="4.3" data-path="dynamic-interaction.html"><a href="dynamic-interaction.html#interaction-can-be-more-than-filtering"><i class="fa fa-check"></i><b>4.3</b> Interaction can be more than filtering</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="themes-and-styling.html"><a href="themes-and-styling.html"><i class="fa fa-check"></i><b>5</b> Themes and styling</a></li>
<li class="divider"></li>
</a>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interactive data with Shiny flexdashboard</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dynamic-interaction" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Dynamic interaction<a href="dynamic-interaction.html#dynamic-interaction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Next we make things dynamic, which means we enter the world of Shiny<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. The jump here is that we go from being able to hover over and drag around our images, to allowing users to interact with the data. To do that we need two ingredients:</p>
<ol style="list-style-type: decimal">
<li>Input / user-interface</li>
<li>Output / back-end</li>
</ol>
<p>Generally you will ahve to iterate between these two sides to get the result you want. I usually like to start by close your eyes and imagine: What do I want users to manipulate?</p>
<p>Year
Species
Island</p>
<p>Here, we’re going to keep only 2 base dimensions, but alter the figure based on: species, island, and year</p>
<p>So in total, users will be able to make 64 different plots based on all combinations of species, islands, and years. But because the
species (4) x islands (4) x years (4)</p>
<div id="user-interface" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> User interface<a href="dynamic-interaction.html#user-interface" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The UI specific the input
Not all of these are screen-reader friendly</p>
<p>To set up the page, we can specify these options using the various select series of functions.
<!-- see this post for making code chunks verbatim: https://yihui.org/en/2017/11/knitr-verbatim-code-chunk/
--></p>
<p>There are different kinds of selectors…</p>
<p>let’s use a basic one</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb8-1"><a href="dynamic-interaction.html#cb8-1" tabindex="-1"></a>---</span>
<span id="cb8-2"><a href="dynamic-interaction.html#cb8-2" tabindex="-1"></a>title: &#39;Palmer Penguin Dashboard&#39;</span>
<span id="cb8-3"><a href="dynamic-interaction.html#cb8-3" tabindex="-1"></a>runtime: shiny</span>
<span id="cb8-4"><a href="dynamic-interaction.html#cb8-4" tabindex="-1"></a>output:</span>
<span id="cb8-5"><a href="dynamic-interaction.html#cb8-5" tabindex="-1"></a>  flexdashboard::flex_dashboard:</span>
<span id="cb8-6"><a href="dynamic-interaction.html#cb8-6" tabindex="-1"></a>---</span>
<span id="cb8-7"><a href="dynamic-interaction.html#cb8-7" tabindex="-1"></a></span>
<span id="cb8-8"><a href="dynamic-interaction.html#cb8-8" tabindex="-1"></a>```{r, echo = F, warning = F, message = F}</span>
<span id="cb8-9"><a href="dynamic-interaction.html#cb8-9" tabindex="-1"></a>library(tidyverse)</span>
<span id="cb8-10"><a href="dynamic-interaction.html#cb8-10" tabindex="-1"></a>library(palmerpenguins)</span>
<span id="cb8-11"><a href="dynamic-interaction.html#cb8-11" tabindex="-1"></a>library(plotly)</span>
<span id="cb8-12"><a href="dynamic-interaction.html#cb8-12" tabindex="-1"></a>```</span>
<span id="cb8-13"><a href="dynamic-interaction.html#cb8-13" tabindex="-1"></a></span>
<span id="cb8-14"><a href="dynamic-interaction.html#cb8-14" tabindex="-1"></a>## Column {.sidebar}</span>
<span id="cb8-15"><a href="dynamic-interaction.html#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="dynamic-interaction.html#cb8-16" tabindex="-1"></a>```{r}</span>
<span id="cb8-17"><a href="dynamic-interaction.html#cb8-17" tabindex="-1"></a>selectInput(&quot;species&quot;, &quot;Species&quot;, </span>
<span id="cb8-18"><a href="dynamic-interaction.html#cb8-18" tabindex="-1"></a>           choices=c(&quot;All&quot;, </span>
<span id="cb8-19"><a href="dynamic-interaction.html#cb8-19" tabindex="-1"></a>                     unique(as.character(penguins$species))),</span>
<span id="cb8-20"><a href="dynamic-interaction.html#cb8-20" tabindex="-1"></a>                     selected=&quot;All&quot;, multiple=F)</span>
<span id="cb8-21"><a href="dynamic-interaction.html#cb8-21" tabindex="-1"></a>```</span></code></pre></div>
<p>What this does under the hood is actually create a data frame called input, which different columns that specify each condition.</p>
<p>so based on what we select, we’re creating a data frame like this:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="dynamic-interaction.html#cb9-1" tabindex="-1"></a>input <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">&#39;species&#39;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;All&quot;</span>, </span>
<span id="cb9-2"><a href="dynamic-interaction.html#cb9-2" tabindex="-1"></a>                     <span class="fu">unique</span>(<span class="fu">as.character</span>(penguins<span class="sc">$</span>species))))</span>
<span id="cb9-3"><a href="dynamic-interaction.html#cb9-3" tabindex="-1"></a>input                     </span></code></pre></div>
<pre><code>##     species
## 1       All
## 2    Adelie
## 3    Gentoo
## 4 Chinstrap</code></pre>
<p>So we can add this in and see that the new page changes – we now have a selector.</p>
<p>That is th euser end. But it doesn’t work yet because we need to connect it to the back end.</p>
</div>
<div id="server-output" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Server output<a href="dynamic-interaction.html#server-output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The mechanics that makes the graph reactive to what we select as an input</p>
<p>To connect to the output we need 2 steps:
1. preparing the data
2. wrapping our plot in the right function</p>
<p>Preparing the data&gt; You are creating a reactive function called selectedData. You could all this whatever you wanted, really. But the idea is you are creating a function that will create a new data frame every tie the selector inputs are changed.</p>
<p>This is the hardest step because it forces you to think about the conditionality and shape of your data</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb11-1"><a href="dynamic-interaction.html#cb11-1" tabindex="-1"></a>```{r}</span>
<span id="cb11-2"><a href="dynamic-interaction.html#cb11-2" tabindex="-1"></a>selectedData &lt;- reactive({</span>
<span id="cb11-3"><a href="dynamic-interaction.html#cb11-3" tabindex="-1"></a>  if(input$species == &quot;All&quot;){</span>
<span id="cb11-4"><a href="dynamic-interaction.html#cb11-4" tabindex="-1"></a>    penguins</span>
<span id="cb11-5"><a href="dynamic-interaction.html#cb11-5" tabindex="-1"></a>  } else {</span>
<span id="cb11-6"><a href="dynamic-interaction.html#cb11-6" tabindex="-1"></a>    penguins %&gt;% filter(species == input$species)</span>
<span id="cb11-7"><a href="dynamic-interaction.html#cb11-7" tabindex="-1"></a>  }</span>
<span id="cb11-8"><a href="dynamic-interaction.html#cb11-8" tabindex="-1"></a>})</span>
<span id="cb11-9"><a href="dynamic-interaction.html#cb11-9" tabindex="-1"></a>```</span></code></pre></div>
<p>Step 2 is easier. We just change two things: 1. we replace our static data with the reactive data function, which we called seleectedData. And then 2. we wrap the whole plot in a function called renderPlot()</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb12-1"><a href="dynamic-interaction.html#cb12-1" tabindex="-1"></a>```{r}</span>
<span id="cb12-2"><a href="dynamic-interaction.html#cb12-2" tabindex="-1"></a>renderPlot({</span>
<span id="cb12-3"><a href="dynamic-interaction.html#cb12-3" tabindex="-1"></a> ggplot(selectedData(), aes(x = bill_length_mm, y = bill_depth_mm)) +</span>
<span id="cb12-4"><a href="dynamic-interaction.html#cb12-4" tabindex="-1"></a>  geom_point(size = 2, color = &quot;#51127C&quot;) +</span>
<span id="cb12-5"><a href="dynamic-interaction.html#cb12-5" tabindex="-1"></a>  theme_minimal() +</span>
<span id="cb12-6"><a href="dynamic-interaction.html#cb12-6" tabindex="-1"></a>  labs(x = &quot;Length (mm)&quot;, y = &quot;Depth (mm)&quot;)</span>
<span id="cb12-7"><a href="dynamic-interaction.html#cb12-7" tabindex="-1"></a>}) </span>
<span id="cb12-8"><a href="dynamic-interaction.html#cb12-8" tabindex="-1"></a>```</span></code></pre></div>
<p>Let’s try to do this with several of our laters</p>
<p>We add more selectors</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb13-1"><a href="dynamic-interaction.html#cb13-1" tabindex="-1"></a>```{r}</span>
<span id="cb13-2"><a href="dynamic-interaction.html#cb13-2" tabindex="-1"></a>selectInput(&quot;species&quot;, &quot;Species&quot;, </span>
<span id="cb13-3"><a href="dynamic-interaction.html#cb13-3" tabindex="-1"></a>           choices=c(&quot;All&quot;, </span>
<span id="cb13-4"><a href="dynamic-interaction.html#cb13-4" tabindex="-1"></a>                     unique(as.character(penguins$species))),</span>
<span id="cb13-5"><a href="dynamic-interaction.html#cb13-5" tabindex="-1"></a>                     selected=&quot;All&quot;, multiple=F)</span>
<span id="cb13-6"><a href="dynamic-interaction.html#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="dynamic-interaction.html#cb13-7" tabindex="-1"></a>selectInput(&quot;island&quot;, &quot;Island&quot;, </span>
<span id="cb13-8"><a href="dynamic-interaction.html#cb13-8" tabindex="-1"></a>           choices=c(&quot;All&quot;, </span>
<span id="cb13-9"><a href="dynamic-interaction.html#cb13-9" tabindex="-1"></a>                     unique(as.character(penguins$island))),</span>
<span id="cb13-10"><a href="dynamic-interaction.html#cb13-10" tabindex="-1"></a>                     selected=&quot;All&quot;, multiple=F)</span>
<span id="cb13-11"><a href="dynamic-interaction.html#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="dynamic-interaction.html#cb13-12" tabindex="-1"></a>selectInput(&quot;year&quot;, &quot;Year&quot;, </span>
<span id="cb13-13"><a href="dynamic-interaction.html#cb13-13" tabindex="-1"></a>           choices=c(&quot;All&quot;, </span>
<span id="cb13-14"><a href="dynamic-interaction.html#cb13-14" tabindex="-1"></a>                     unique(penguins$year)),</span>
<span id="cb13-15"><a href="dynamic-interaction.html#cb13-15" tabindex="-1"></a>                     selected=&quot;All&quot;, multiple=F)</span>
<span id="cb13-16"><a href="dynamic-interaction.html#cb13-16" tabindex="-1"></a>```</span></code></pre></div>
<p>And whenever we add more selectors we have to update our data selection function to react to those selectors</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb14-1"><a href="dynamic-interaction.html#cb14-1" tabindex="-1"></a>```{r}</span>
<span id="cb14-2"><a href="dynamic-interaction.html#cb14-2" tabindex="-1"></a>selectedData &lt;- reactive({</span>
<span id="cb14-3"><a href="dynamic-interaction.html#cb14-3" tabindex="-1"></a>  if(input$species == &quot;All&quot;){</span>
<span id="cb14-4"><a href="dynamic-interaction.html#cb14-4" tabindex="-1"></a>    penguins_s &lt;- penguins</span>
<span id="cb14-5"><a href="dynamic-interaction.html#cb14-5" tabindex="-1"></a>  } else {</span>
<span id="cb14-6"><a href="dynamic-interaction.html#cb14-6" tabindex="-1"></a>    penguins_s &lt;- penguins %&gt;% filter(species == input$species)</span>
<span id="cb14-7"><a href="dynamic-interaction.html#cb14-7" tabindex="-1"></a>  }</span>
<span id="cb14-8"><a href="dynamic-interaction.html#cb14-8" tabindex="-1"></a>  if(input$island == &quot;All&quot;){</span>
<span id="cb14-9"><a href="dynamic-interaction.html#cb14-9" tabindex="-1"></a>    penguins_si &lt;- penguins_s</span>
<span id="cb14-10"><a href="dynamic-interaction.html#cb14-10" tabindex="-1"></a>  } else {</span>
<span id="cb14-11"><a href="dynamic-interaction.html#cb14-11" tabindex="-1"></a>    penguins_si &lt;- penguins_s %&gt;% filter(island == input$island)</span>
<span id="cb14-12"><a href="dynamic-interaction.html#cb14-12" tabindex="-1"></a>  }</span>
<span id="cb14-13"><a href="dynamic-interaction.html#cb14-13" tabindex="-1"></a>  if(input$year == &quot;All&quot;){</span>
<span id="cb14-14"><a href="dynamic-interaction.html#cb14-14" tabindex="-1"></a>    penguins_siy &lt;- penguins_si</span>
<span id="cb14-15"><a href="dynamic-interaction.html#cb14-15" tabindex="-1"></a>  } else {</span>
<span id="cb14-16"><a href="dynamic-interaction.html#cb14-16" tabindex="-1"></a>    penguins_siy &lt;- penguins_si %&gt;% filter(year == input$year)</span>
<span id="cb14-17"><a href="dynamic-interaction.html#cb14-17" tabindex="-1"></a>  }</span>
<span id="cb14-18"><a href="dynamic-interaction.html#cb14-18" tabindex="-1"></a>  return(penguins_siy)</span>
<span id="cb14-19"><a href="dynamic-interaction.html#cb14-19" tabindex="-1"></a>  })</span>
<span id="cb14-20"><a href="dynamic-interaction.html#cb14-20" tabindex="-1"></a>```</span></code></pre></div>
<p>Then we don’t need to change our plot</p>
</div>
<div id="interaction-can-be-more-than-filtering" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Interaction can be more than filtering<a href="dynamic-interaction.html#interaction-can-be-more-than-filtering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s say we didn’t just want to filter/reduce the data. What if we wanted to color the points of the plot by different things. Here, we don’t need to have reactive data selection at all, we just need ggplot to respond to the input by adding and elment (or not)</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb15-1"><a href="dynamic-interaction.html#cb15-1" tabindex="-1"></a>```{r}</span>
<span id="cb15-2"><a href="dynamic-interaction.html#cb15-2" tabindex="-1"></a>selectInput(&quot;fill_var&quot;, &quot;Color points by...&quot;, </span>
<span id="cb15-3"><a href="dynamic-interaction.html#cb15-3" tabindex="-1"></a>           choices=c(&quot;None&quot;,</span>
<span id="cb15-4"><a href="dynamic-interaction.html#cb15-4" tabindex="-1"></a>                     &quot;species&quot;,</span>
<span id="cb15-5"><a href="dynamic-interaction.html#cb15-5" tabindex="-1"></a>                     &quot;island&quot;,</span>
<span id="cb15-6"><a href="dynamic-interaction.html#cb15-6" tabindex="-1"></a>                      &quot;year&quot;),</span>
<span id="cb15-7"><a href="dynamic-interaction.html#cb15-7" tabindex="-1"></a>                     selected=&quot;None&quot;, multiple=F)</span>
<span id="cb15-8"><a href="dynamic-interaction.html#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="dynamic-interaction.html#cb15-9" tabindex="-1"></a>```</span></code></pre></div>
<p>Now, we only are focusing on one input, input$fill_var. This input value is going to specify if we want to color by anything, and if so, which column. So instead of making the data selection conditional on our input, we can make the plot conditional on the input:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb16-1"><a href="dynamic-interaction.html#cb16-1" tabindex="-1"></a>```{r} </span>
<span id="cb16-2"><a href="dynamic-interaction.html#cb16-2" tabindex="-1"></a>renderPlot({</span>
<span id="cb16-3"><a href="dynamic-interaction.html#cb16-3" tabindex="-1"></a>  if(input$fill_var == &quot;None&quot;){</span>
<span id="cb16-4"><a href="dynamic-interaction.html#cb16-4" tabindex="-1"></a>    # Make the same plot as before</span>
<span id="cb16-5"><a href="dynamic-interaction.html#cb16-5" tabindex="-1"></a>     ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +</span>
<span id="cb16-6"><a href="dynamic-interaction.html#cb16-6" tabindex="-1"></a>      geom_point(size = 2, color = &quot;#51127CF&quot;) +</span>
<span id="cb16-7"><a href="dynamic-interaction.html#cb16-7" tabindex="-1"></a>      theme_minimal() +</span>
<span id="cb16-8"><a href="dynamic-interaction.html#cb16-8" tabindex="-1"></a>      labs(x = &quot;Length (mm)&quot;, y = &quot;Depth (mm)&quot;)</span>
<span id="cb16-9"><a href="dynamic-interaction.html#cb16-9" tabindex="-1"></a>  } else {</span>
<span id="cb16-10"><a href="dynamic-interaction.html#cb16-10" tabindex="-1"></a>    # Add in the input</span>
<span id="cb16-11"><a href="dynamic-interaction.html#cb16-11" tabindex="-1"></a>     ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, </span>
<span id="cb16-12"><a href="dynamic-interaction.html#cb16-12" tabindex="-1"></a>                          color = input$fill_var)) +</span>
<span id="cb16-13"><a href="dynamic-interaction.html#cb16-13" tabindex="-1"></a>      geom_point() +</span>
<span id="cb16-14"><a href="dynamic-interaction.html#cb16-14" tabindex="-1"></a>      theme_minimal() +</span>
<span id="cb16-15"><a href="dynamic-interaction.html#cb16-15" tabindex="-1"></a>      labs(x = &quot;Length (mm)&quot;, y = &quot;Depth (mm)&quot;)</span>
<span id="cb16-16"><a href="dynamic-interaction.html#cb16-16" tabindex="-1"></a>  }</span>
<span id="cb16-17"><a href="dynamic-interaction.html#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="dynamic-interaction.html#cb16-18" tabindex="-1"></a>}) </span>
<span id="cb16-19"><a href="dynamic-interaction.html#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="dynamic-interaction.html#cb16-20" tabindex="-1"></a>```</span></code></pre></div>
<p>BUT, when we try this we get a frustrating result. It is evaluating input$fill_var as text, not as a column name in the data frame. How do we get around this? We have to be very specific with R, telling it to evaluation the text as an object. We don’t get too much into this, but we will do it using these two functions:</p>
<pre><code>eval(parse(text = input$fill_var))</code></pre>
<p>So when we add that in, we get what we want:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb18-1"><a href="dynamic-interaction.html#cb18-1" tabindex="-1"></a>```{r} </span>
<span id="cb18-2"><a href="dynamic-interaction.html#cb18-2" tabindex="-1"></a>renderPlot({</span>
<span id="cb18-3"><a href="dynamic-interaction.html#cb18-3" tabindex="-1"></a>  if(input$fill_var == &quot;None&quot;){</span>
<span id="cb18-4"><a href="dynamic-interaction.html#cb18-4" tabindex="-1"></a>    # Make the same plot as before</span>
<span id="cb18-5"><a href="dynamic-interaction.html#cb18-5" tabindex="-1"></a>     ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm)) +</span>
<span id="cb18-6"><a href="dynamic-interaction.html#cb18-6" tabindex="-1"></a>      geom_point() +</span>
<span id="cb18-7"><a href="dynamic-interaction.html#cb18-7" tabindex="-1"></a>      theme_minimal() +</span>
<span id="cb18-8"><a href="dynamic-interaction.html#cb18-8" tabindex="-1"></a>      labs(x = &quot;Length (mm)&quot;, y = &quot;Depth (mm)&quot;)</span>
<span id="cb18-9"><a href="dynamic-interaction.html#cb18-9" tabindex="-1"></a>  } else {</span>
<span id="cb18-10"><a href="dynamic-interaction.html#cb18-10" tabindex="-1"></a>    # Add in the input, make sure to evaluate the parsed text so that R</span>
<span id="cb18-11"><a href="dynamic-interaction.html#cb18-11" tabindex="-1"></a>    # thinks of it as a variable and not just text</span>
<span id="cb18-12"><a href="dynamic-interaction.html#cb18-12" tabindex="-1"></a>     ggplot(penguins, aes(x = bill_length_mm, y = bill_depth_mm, </span>
<span id="cb18-13"><a href="dynamic-interaction.html#cb18-13" tabindex="-1"></a>                          color = eval(parse(text = input$fill_var)))) +</span>
<span id="cb18-14"><a href="dynamic-interaction.html#cb18-14" tabindex="-1"></a>      geom_point() +</span>
<span id="cb18-15"><a href="dynamic-interaction.html#cb18-15" tabindex="-1"></a>      theme_minimal() +</span>
<span id="cb18-16"><a href="dynamic-interaction.html#cb18-16" tabindex="-1"></a>      labs(x = &quot;Length (mm)&quot;, y = &quot;Depth (mm)&quot;, color = &quot;&quot;)</span>
<span id="cb18-17"><a href="dynamic-interaction.html#cb18-17" tabindex="-1"></a>  }</span>
<span id="cb18-18"><a href="dynamic-interaction.html#cb18-18" tabindex="-1"></a>}) </span>
<span id="cb18-19"><a href="dynamic-interaction.html#cb18-19" tabindex="-1"></a></span>
<span id="cb18-20"><a href="dynamic-interaction.html#cb18-20" tabindex="-1"></a>```</span></code></pre></div>
<p>BOOKMARK: IN GGPLOT, EACH DIMENSION IS ITS OWN COLUMN</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Mind the Note in Introduction: We are NOT learning full-blown Shiny.<a href="dynamic-interaction.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="static-interaction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="themes-and-styling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/liza-wood/intro-shiny/edit/master/04_dynamic-interaction.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/liza-wood/intro-shiny/blob/master/04_dynamic-interaction.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"code_folding": "show"
});
});
</script>

</body>

</html>
